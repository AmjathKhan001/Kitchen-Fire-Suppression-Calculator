<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional KFSS Calculator | Kitchen Fire Safety Design Tool</title>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-376208036"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-376208036');
    </script>
    
    <!-- Google AdSense Auto Ads -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6687860250561653" crossorigin="anonymous"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- CSS -->
    <link rel="stylesheet" href="style.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ”¥</text></svg>">
    
    <!-- INLINE JAVASCRIPT - NO EXTERNAL FILE NEEDED -->
    <script>
        // KFSS Calculator - All JavaScript in one place
        const KFSSCalculator = {
            // State variables
            currentCalculation: null,
            recentCalculations: [],
            expertMode: false,
            
            // Standard appliances database
            standardAppliances: [
                { id: 'fryer', name: 'Deep Fryer', nozzles: 1, price: 850 },
                { id: 'range', name: 'Cooking Range', nozzles: 2, price: 1200 },
                { id: 'grill', name: 'Griddle/Grill', nozzles: 1, price: 750 },
                { id: 'broiler', name: 'Broiler', nozzles: 1, price: 900 },
                { id: 'wok', name: 'Wok Station', nozzles: 2, price: 1100 },
                { id: 'oven', name: 'Convection Oven', nozzles: 1, price: 650 },
                { id: 'steamer', name: 'Steamer', nozzles: 1, price: 700 },
                { id: 'dishwasher', name: 'Dishwasher', nozzles: 1, price: 600 }
            ],
            
            // Component pricing (in USD)
            pricing: {
                nozzle: 85,
                cylinder_5kg: 1200,
                cylinder_10kg: 1900,
                piping_per_meter: 35,
                hood_agent_tank: 1800,
                manual_release: 250,
                installation_labor: 850,
                commissioning: 400
            },
            
            // Currency exchange rates (approximate)
            exchangeRates: {
                USD: 1.0,
                EUR: 0.92,
                INR: 83.0,
                AED: 3.67
            },
            
            // Currency symbols
            currencySymbols: {
                USD: '$',
                EUR: 'â‚¬',
                INR: 'â‚¹',
                AED: 'Ø¯.Ø¥'
            },
            
            // Safety Features
            SafetyFeatures: {
                minRequirements: {
                    hoodArea: 0.5,
                    nozzlesPerAppliance: 1,
                    maxNozzlesPerCylinder: 6,
                    minPlenumSections: 1,
                    minHoodLength: 0.5,
                    minHoodDepth: 0.5
                },
                
                warnings: [],
                
                checkRequirements: function() {
                    this.warnings = [];
                    
                    const hoodLength = parseFloat(document.getElementById('hoodLength')?.value) || 0;
                    const hoodDepth = parseFloat(document.getElementById('hoodDepth')?.value) || 0;
                    const hoodArea = hoodLength * hoodDepth;
                    const plenumSections = parseInt(document.getElementById('plenumSections')?.value) || 0;
                    const ductSections = parseInt(document.getElementById('ductSections')?.value) || 0;
                    
                    if (hoodArea < this.minRequirements.hoodArea) {
                        this.warnings.push(`Hood area (${hoodArea.toFixed(1)} mÂ²) is below minimum recommended (${this.minRequirements.hoodArea} mÂ²)`);
                    }
                    
                    if (plenumSections < this.minRequirements.minPlenumSections) {
                        this.warnings.push(`Minimum ${this.minRequirements.minPlenumSections} plenum section required`);
                    }
                    
                    if (hoodLength < this.minRequirements.minHoodLength) {
                        this.warnings.push(`Hood length should be at least ${this.minRequirements.minHoodLength} meters`);
                    }
                    
                    if (hoodDepth < this.minRequirements.minHoodDepth) {
                        this.warnings.push(`Hood depth should be at least ${this.minRequirements.minHoodDepth} meters`);
                    }
                    
                    const selectedAppliances = document.querySelectorAll('.appliance-item.selected');
                    let applianceNozzles = 0;
                    selectedAppliances.forEach(item => {
                        applianceNozzles += parseInt(item.dataset.nozzles) || 1;
                    });
                    
                    const totalNozzles = plenumSections + ductSections + applianceNozzles;
                    const cylindersRequired = Math.ceil(totalNozzles / this.minRequirements.maxNozzlesPerCylinder);
                    
                    if (cylindersRequired > 3) {
                        this.warnings.push(`System requires ${cylindersRequired} cylinders. Consider redesign for better efficiency.`);
                    }
                    
                    return this.warnings;
                },
                
                displayWarnings: function() {
                    const warningContainer = document.getElementById('safetyWarnings');
                    if (!warningContainer) return;
                    
                    const warnings = this.checkRequirements();
                    
                    if (warnings.length === 0) {
                        warningContainer.innerHTML = `
                            <div class="safety-status safe">
                                <i class="fas fa-check-circle"></i>
                                <div>
                                    <strong>All safety requirements met</strong>
                                    <small>System design meets minimum NFPA standards</small>
                                </div>
                            </div>
                        `;
                        return;
                    }
                    
                    let html = `
                        <div class="safety-status warning">
                            <i class="fas fa-exclamation-triangle"></i>
                            <div>
                                <strong>Safety Recommendations</strong>
                                <small>${warnings.length} item${warnings.length > 1 ? 's' : ''} to review</small>
                            </div>
                        </div>
                        <ul class="warning-list">
                    `;
                    
                    warnings.forEach(warning => {
                        html += `<li><i class="fas fa-info-circle"></i> ${warning}</li>`;
                    });
                    
                    html += '</ul>';
                    warningContainer.innerHTML = html;
                }
            },
            
            /**
             * Initialize the calculator
             */
            init: function() {
                console.log('Initializing KFSS Calculator...');
                
                // Initialize appliances
                this.initializeAppliances();
                
                // Setup event listeners
                this.setupEventListeners();
                
                // Setup expert mode toggle
                this.setupExpertModeToggle();
                
                // Load recent calculations
                this.loadRecentCalculations();
                
                // Load last calculation if available
                this.loadLastCalculation();
                
                // Update summary with initial values
                this.updateSummary();
                
                // Display safety warnings
                this.SafetyFeatures.displayWarnings();
                
                console.log('KFSS Calculator initialized successfully!');
            },
            
            /**
             * Initialize appliance list
             */
            initializeAppliances: function() {
                const applianceList = document.getElementById('applianceList');
                if (!applianceList) return;
                
                applianceList.innerHTML = '';
                
                this.standardAppliances.forEach(appliance => {
                    const item = document.createElement('div');
                    item.className = 'appliance-item';
                    item.dataset.id = appliance.id;
                    item.dataset.nozzles = appliance.nozzles;
                    item.dataset.price = appliance.price;
                    
                    item.innerHTML = `
                        <div class="appliance-name">${appliance.name}</div>
                        <div class="appliance-nozzles">${appliance.nozzles} nozzle${appliance.nozzles > 1 ? 's' : ''}</div>
                    `;
                    
                    item.addEventListener('click', () => {
                        item.classList.toggle('selected');
                        this.updateSummary();
                        this.SafetyFeatures.displayWarnings();
                    });
                    
                    applianceList.appendChild(item);
                });
            },
            
            /**
             * Set up event listeners
             */
            setupEventListeners: function() {
                // Calculate button
                const calculateBtn = document.getElementById('calculateBtn');
                if (calculateBtn) {
                    calculateBtn.addEventListener('click', () => this.performCalculation());
                }
                
                // Reset button
                const resetBtn = document.getElementById('resetBtn');
                if (resetBtn) {
                    resetBtn.addEventListener('click', () => this.resetCalculator());
                }
                
                // Custom appliance addition
                const addCustomBtn = document.getElementById('addCustomAppliance');
                if (addCustomBtn) {
                    addCustomBtn.addEventListener('click', () => this.addCustomAppliance());
                }
                
                // Form input listeners for real-time updates
                const inputs = ['projectName', 'clientName', 'projectLocation', 'hoodLength', 
                               'hoodDepth', 'plenumSections', 'ductSections', 'currency'];
                
                inputs.forEach(inputId => {
                    const input = document.getElementById(inputId);
                    if (input) {
                        input.addEventListener('input', () => {
                            this.updateSummary();
                            this.SafetyFeatures.displayWarnings();
                        });
                        input.addEventListener('change', () => {
                            this.updateSummary();
                            this.SafetyFeatures.displayWarnings();
                        });
                    }
                });
                
                // Expert mode fields
                const expertInputs = ['hoodMaterial', 'ductLength', 'nozzleType', 'pipeMaterial', 
                                     'safetyFactor', 'pressureRating', 'additionalNotes'];
                
                expertInputs.forEach(inputId => {
                    const input = document.getElementById(inputId);
                    if (input) {
                        input.addEventListener('change', () => {
                            this.updateSummary();
                            this.SafetyFeatures.displayWarnings();
                        });
                    }
                });
                
                // Export buttons
                const exportJson = document.getElementById('exportJson');
                if (exportJson) {
                    exportJson.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.exportCalculation('json');
                    });
                }
                
                const exportCsv = document.getElementById('exportCsv');
                if (exportCsv) {
                    exportCsv.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.exportCalculation('csv');
                    });
                }
                
                const shareLink = document.getElementById('shareLink');
                if (shareLink) {
                    shareLink.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.generateShareableLink();
                    });
                }
            },
            
            /**
             * Set up expert mode toggle
             */
            setupExpertModeToggle: function() {
                const toggle = document.getElementById('expertModeToggle');
                const expertPanel = document.getElementById('expertPanel');
                const expertHoodPanel = document.getElementById('expertHoodPanel');
                
                if (!toggle) return;
                
                // Load expert mode state
                const savedMode = localStorage.getItem('kfss_expert_mode');
                this.expertMode = savedMode === 'true';
                toggle.checked = this.expertMode;
                
                // Set initial state
                this.updateExpertModeDisplay();
                
                // Add event listener
                toggle.addEventListener('change', (e) => {
                    this.expertMode = e.target.checked;
                    localStorage.setItem('kfss_expert_mode', this.expertMode);
                    this.updateExpertModeDisplay();
                    this.updateSummary();
                    this.SafetyFeatures.displayWarnings();
                });
            },
            
            /**
             * Update expert mode display
             */
            updateExpertModeDisplay: function() {
                const expertPanel = document.getElementById('expertPanel');
                const expertHoodPanel = document.getElementById('expertHoodPanel');
                
                if (expertPanel) {
                    if (this.expertMode) {
                        expertPanel.classList.add('expanded');
                    } else {
                        expertPanel.classList.remove('expanded');
                    }
                }
                
                if (expertHoodPanel) {
                    if (this.expertMode) {
                        expertHoodPanel.classList.add('expanded');
                    } else {
                        expertHoodPanel.classList.remove('expanded');
                    }
                }
            },
            
            /**
             * Update the summary panel with current values
             */
            updateSummary: function() {
                // Get form values
                const hoodLength = parseFloat(document.getElementById('hoodLength')?.value) || 3.0;
                const hoodDepth = parseFloat(document.getElementById('hoodDepth')?.value) || 1.2;
                const plenumSections = parseInt(document.getElementById('plenumSections')?.value) || 2;
                const ductSections = parseInt(document.getElementById('ductSections')?.value) || 1;
                const currency = document.getElementById('currency')?.value || 'USD';
                
                // Calculate hood area
                const hoodArea = hoodLength * hoodDepth;
                
                // Calculate selected appliances
                const selectedAppliances = document.querySelectorAll('.appliance-item.selected');
                let applianceNozzles = 0;
                let applianceCost = 0;
                
                selectedAppliances.forEach(item => {
                    applianceNozzles += parseInt(item.dataset.nozzles) || 1;
                    applianceCost += parseFloat(item.dataset.price) || 0;
                });
                
                // Calculate totals
                const totalNozzles = plenumSections + ductSections + applianceNozzles;
                const cylindersRequired = Math.ceil(totalNozzles / 6);
                const agentWeight = cylindersRequired * 5.7;
                const pipingLength = (totalNozzles * 2) + 5;
                
                // Calculate cost
                let totalCost = 0;
                totalCost += totalNozzles * this.pricing.nozzle;
                totalCost += cylindersRequired * (cylindersRequired > 1 ? this.pricing.cylinder_10kg : this.pricing.cylinder_5kg);
                totalCost += pipingLength * this.pricing.piping_per_meter;
                totalCost += this.pricing.hood_agent_tank;
                totalCost += this.pricing.manual_release;
                totalCost += this.pricing.installation_labor;
                totalCost += this.pricing.commissioning;
                totalCost += applianceCost;
                
                // Apply currency conversion
                const exchangeRate = this.exchangeRates[currency] || 1;
                totalCost *= exchangeRate;
                
                // Update summary display
                this.updateElementText('summaryHoodArea', hoodArea.toFixed(1) + ' mÂ²');
                this.updateElementText('summaryPlenumNozzles', plenumSections);
                this.updateElementText('summaryDuctNozzles', ductSections);
                this.updateElementText('summaryApplianceNozzles', applianceNozzles);
                this.updateElementText('summaryTotalNozzles', totalNozzles);
                this.updateElementText('summaryCylinders', cylindersRequired);
                this.updateElementText('summaryAgentWeight', agentWeight.toFixed(1) + ' kg');
                this.updateElementText('summaryPiping', Math.round(pipingLength) + ' m');
                this.updateElementText('summaryCurrency', currency);
                
                // Format cost with currency symbol
                const symbol = this.currencySymbols[currency] || '$';
                const formattedCost = symbol + totalCost.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
                this.updateElementText('summaryCost', formattedCost);
                
                // Update project info in results nav
                const projectName = document.getElementById('projectName')?.value || 'Project Name';
                const clientName = document.getElementById('clientName')?.value || 'Client Name';
                
                this.updateElementText('resultProjectName', projectName);
                this.updateElementText('resultClientName', clientName);
            },
            
            /**
             * Perform the full calculation
             */
            performCalculation: function() {
                // Get all form values
                const projectName = document.getElementById('projectName')?.value || 'Unnamed Project';
                const clientName = document.getElementById('clientName')?.value || 'Unnamed Client';
                const projectLocation = document.getElementById('projectLocation')?.value || '';
                const hoodLength = parseFloat(document.getElementById('hoodLength')?.value) || 0;
                const hoodDepth = parseFloat(document.getElementById('hoodDepth')?.value) || 0;
                const plenumSections = parseInt(document.getElementById('plenumSections')?.value) || 0;
                const ductSections = parseInt(document.getElementById('ductSections')?.value) || 0;
                const currency = document.getElementById('currency')?.value || 'USD';
                
                // Expert mode values
                const hoodMaterial = document.getElementById('hoodMaterial')?.value || 'stainless';
                const ductLength = parseFloat(document.getElementById('ductLength')?.value) || 5.0;
                const nozzleType = document.getElementById('nozzleType')?.value || 'standard';
                const pipeMaterial = document.getElementById('pipeMaterial')?.value || 'galvanized';
                const safetyFactor = parseInt(document.getElementById('safetyFactor')?.value) || 10;
                const pressureRating = parseInt(document.getElementById('pressureRating')?.value) || 100;
                const additionalNotes = document.getElementById('additionalNotes')?.value || '';
                
                // Validate required fields
                if (!projectName.trim() || !clientName.trim()) {
                    alert('Please fill in Project Name and Client Name');
                    return;
                }
                
                if (hoodLength <= 0 || hoodDepth <= 0) {
                    alert('Please enter valid hood dimensions');
                    return;
                }
                
                // Check safety warnings
                const warnings = this.SafetyFeatures.checkRequirements();
                if (warnings.length > 0) {
                    const proceed = confirm(`There are ${warnings.length} safety recommendations. Do you want to proceed anyway?\n\nClick OK to continue, Cancel to review.`);
                    if (!proceed) return;
                }
                
                // Get selected appliances
                const selectedAppliances = [];
                const selectedApplianceItems = document.querySelectorAll('.appliance-item.selected');
                
                selectedApplianceItems.forEach(item => {
                    const applianceId = item.dataset.id;
                    const appliance = this.standardAppliances.find(a => a.id === applianceId);
                    if (appliance) {
                        selectedAppliances.push({
                            id: appliance.id,
                            name: appliance.name,
                            nozzles: appliance.nozzles,
                            price: appliance.price
                        });
                    }
                });
                
                // Calculate everything
                const hoodArea = hoodLength * hoodDepth;
                const applianceNozzles = selectedAppliances.reduce((sum, app) => sum + app.nozzles, 0);
                const totalNozzles = plenumSections + ductSections + applianceNozzles;
                const cylindersRequired = Math.ceil(totalNozzles / 6);
                const agentWeight = cylindersRequired * 5.7;
                const pipingLength = (totalNozzles * 2) + 5 + (this.expertMode ? ductLength : 0);
                
                // Calculate costs
                let subtotals = {
                    nozzles: totalNozzles * this.pricing.nozzle,
                    cylinders: cylindersRequired * (cylindersRequired > 1 ? this.pricing.cylinder_10kg : this.pricing.cylinder_5kg),
                    piping: pipingLength * this.pricing.piping_per_meter,
                    hoodAgentTank: this.pricing.hood_agent_tank,
                    manualRelease: this.pricing.manual_release,
                    installationLabor: this.pricing.installation_labor,
                    commissioning: this.pricing.commissioning,
                    appliances: selectedAppliances.reduce((sum, app) => sum + app.price, 0)
                };
                
                // Apply safety factor
                const safetyMultiplier = 1 + (safetyFactor / 100);
                Object.keys(subtotals).forEach(key => {
                    subtotals[key] *= safetyMultiplier;
                });
                
                // Calculate total
                let totalCost = Object.values(subtotals).reduce((sum, val) => sum + val, 0);
                
                // Apply currency conversion
                const exchangeRate = this.exchangeRates[currency] || 1;
                totalCost *= exchangeRate;
                
                // Create calculation object
                this.currentCalculation = {
                    id: Date.now(),
                    timestamp: new Date().toISOString(),
                    project: {
                        name: projectName,
                        client: clientName,
                        location: projectLocation,
                        currency: currency
                    },
                    configuration: {
                        hood: {
                            length: hoodLength,
                            depth: hoodDepth,
                            area: hoodArea,
                            material: hoodMaterial,
                            plenumSections: plenumSections,
                            ductSections: ductSections,
                            ductLength: ductLength
                        },
                        appliances: selectedAppliances,
                        system: {
                            nozzleType: nozzleType,
                            pipeMaterial: pipeMaterial,
                            safetyFactor: safetyFactor,
                            pressureRating: pressureRating,
                            additionalNotes: additionalNotes
                        }
                    },
                    results: {
                        nozzles: {
                            plenum: plenumSections,
                            duct: ductSections,
                            appliances: applianceNozzles,
                            total: totalNozzles
                        },
                        cylinders: cylindersRequired,
                        agentWeight: agentWeight,
                        pipingLength: pipingLength,
                        subtotals: subtotals,
                        totalCost: totalCost,
                        exchangeRate: exchangeRate,
                        safetyWarnings: warnings
                    }
                };
                
                // Save to localStorage
                localStorage.setItem('kfss_last_calculation', JSON.stringify(this.currentCalculation));
                
                // Add to recent calculations
                this.addToRecentCalculations(this.currentCalculation);
                
                // Update UI
                this.updateRecentCalculationsDisplay();
                
                // Redirect to results page
                window.location.href = 'results.html';
            },
            
            /**
             * Add custom appliance
             */
            addCustomAppliance: function() {
                const nameInput = document.getElementById('customAppliance');
                const nozzlesInput = document.getElementById('customNozzles');
                const applianceList = document.getElementById('applianceList');
                
                const name = nameInput.value.trim();
                const nozzles = parseInt(nozzlesInput.value) || 1;
                
                if (!name) {
                    alert('Please enter appliance name');
                    return;
                }
                
                if (nozzles < 1 || nozzles > 5) {
                    alert('Please enter nozzle count between 1-5');
                    return;
                }
                
                // Create custom appliance item
                const item = document.createElement('div');
                item.className = 'appliance-item selected';
                item.dataset.id = 'custom-' + Date.now();
                item.dataset.nozzles = nozzles;
                item.dataset.price = nozzles * 600;
                
                item.innerHTML = `
                    <div class="appliance-name">${name} (Custom)</div>
                    <div class="appliance-nozzles">${nozzles} nozzle${nozzles > 1 ? 's' : ''}</div>
                `;
                
                item.addEventListener('click', () => {
                    item.classList.toggle('selected');
                    this.updateSummary();
                    this.SafetyFeatures.displayWarnings();
                });
                
                applianceList.appendChild(item);
                
                // Clear inputs
                nameInput.value = '';
                nozzlesInput.value = '1';
                
                // Update summary and safety warnings
                this.updateSummary();
                this.SafetyFeatures.displayWarnings();
            },
            
            /**
             * Reset calculator to default values
             */
            resetCalculator: function() {
                if (!confirm('Are you sure you want to reset all inputs to default values?')) {
                    return;
                }
                
                // Reset form inputs
                document.getElementById('projectName').value = 'Commercial Kitchen Design';
                document.getElementById('clientName').value = 'Restaurant Corporation';
                document.getElementById('projectLocation').value = '';
                document.getElementById('hoodLength').value = '3.0';
                document.getElementById('hoodDepth').value = '1.2';
                document.getElementById('plenumSections').value = '2';
                document.getElementById('ductSections').value = '1';
                document.getElementById('currency').value = 'USD';
                
                // Reset expert fields
                document.getElementById('hoodMaterial').value = 'stainless';
                document.getElementById('ductLength').value = '5.0';
                document.getElementById('nozzleType').value = 'standard';
                document.getElementById('pipeMaterial').value = 'galvanized';
                document.getElementById('safetyFactor').value = '10';
                document.getElementById('pressureRating').value = '100';
                document.getElementById('additionalNotes').value = '';
                
                // Deselect all appliances
                document.querySelectorAll('.appliance-item.selected').forEach(item => {
                    item.classList.remove('selected');
                });
                
                // Clear custom appliances
                const customAppliances = document.querySelectorAll('.appliance-item[data-id^="custom-"]');
                customAppliances.forEach(item => item.remove());
                
                // Clear current calculation
                this.currentCalculation = null;
                localStorage.removeItem('kfss_last_calculation');
                
                // Update UI
                this.updateSummary();
                this.updateRecentCalculationsDisplay();
                this.SafetyFeatures.displayWarnings();
            },
            
            /**
             * Load last calculation
             */
            loadLastCalculation: function() {
                const lastCalc = localStorage.getItem('kfss_last_calculation');
                if (lastCalc) {
                    try {
                        this.currentCalculation = JSON.parse(lastCalc);
                        this.updateSummary();
                    } catch (e) {
                        console.error('Failed to load last calculation:', e);
                    }
                }
            },
            
            /**
             * Add calculation to recent list
             */
            addToRecentCalculations: function(calculation) {
                // Add to beginning of array
                this.recentCalculations.unshift(calculation);
                
                // Keep only last 5
                if (this.recentCalculations.length > 5) {
                    this.recentCalculations = this.recentCalculations.slice(0, 5);
                }
                
                // Save to localStorage
                localStorage.setItem('kfss_recent_calculations', JSON.stringify(this.recentCalculations));
            },
            
            /**
             * Load recent calculations from localStorage
             */
            loadRecentCalculations: function() {
                try {
                    const saved = localStorage.getItem('kfss_recent_calculations');
                    if (saved) {
                        this.recentCalculations = JSON.parse(saved);
                    }
                } catch (e) {
                    console.error('Failed to load recent calculations:', e);
                    this.recentCalculations = [];
                }
                
                this.updateRecentCalculationsDisplay();
            },
            
            /**
             * Update recent calculations display
             */
            updateRecentCalculationsDisplay: function() {
                const container = document.getElementById('recentCalculations');
                if (!container) return;
                
                if (this.recentCalculations.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-clock"></i>
                            <p>No recent calculations</p>
                            <small>Your calculations will appear here</small>
                        </div>
                    `;
                    return;
                }
                
                let html = '<div class="recent-list">';
                
                this.recentCalculations.forEach((calc) => {
                    const date = new Date(calc.timestamp);
                    const formattedDate = date.toLocaleDateString();
                    
                    const symbol = this.currencySymbols[calc.project.currency] || '$';
                    const formattedCost = symbol + calc.results.totalCost.toFixed(0);
                    
                    html += `
                        <div class="recent-item" data-id="${calc.id}">
                            <div class="recent-project">${calc.project.name}</div>
                            <div class="recent-details">
                                <span>${calc.results.nozzles.total} nozzles</span>
                                <span>â€¢</span>
                                <span>${formattedCost}</span>
                                <span>â€¢</span>
                                <span>${formattedDate}</span>
                            </div>
                            <button class="btn-recent-load" onclick="KFSSCalculator.loadRecentCalculation(${calc.id})">
                                <i class="fas fa-undo"></i> Load
                            </button>
                        </div>
                    `;
                });
                
                html += '</div>';
                
                container.innerHTML = html;
            },
            
            /**
             * Load a recent calculation
             */
            loadRecentCalculation: function(id) {
                const calculation = this.recentCalculations.find(calc => calc.id === id);
                if (!calculation) return;
                
                this.currentCalculation = calculation;
                localStorage.setItem('kfss_last_calculation', JSON.stringify(calculation));
                
                // Update form fields
                document.getElementById('projectName').value = calculation.project.name;
                document.getElementById('clientName').value = calculation.project.client;
                document.getElementById('projectLocation').value = calculation.project.location || '';
                document.getElementById('currency').value = calculation.project.currency;
                document.getElementById('hoodLength').value = calculation.configuration.hood.length;
                document.getElementById('hoodDepth').value = calculation.configuration.hood.depth;
                document.getElementById('plenumSections').value = calculation.configuration.hood.plenumSections;
                document.getElementById('ductSections').value = calculation.configuration.hood.ductSections;
                
                // Update expert fields if they exist
                if (calculation.configuration.hood.material) {
                    document.getElementById('hoodMaterial').value = calculation.configuration.hood.material;
                }
                if (calculation.configuration.hood.ductLength) {
                    document.getElementById('ductLength').value = calculation.configuration.hood.ductLength;
                }
                if (calculation.configuration.system.nozzleType) {
                    document.getElementById('nozzleType').value = calculation.configuration.system.nozzleType;
                }
                if (calculation.configuration.system.pipeMaterial) {
                    document.getElementById('pipeMaterial').value = calculation.configuration.system.pipeMaterial;
                }
                if (calculation.configuration.system.safetyFactor) {
                    document.getElementById('safetyFactor').value = calculation.configuration.system.safetyFactor;
                }
                if (calculation.configuration.system.pressureRating) {
                    document.getElementById('pressureRating').value = calculation.configuration.system.pressureRating;
                }
                if (calculation.configuration.system.additionalNotes) {
                    document.getElementById('additionalNotes').value = calculation.configuration.system.additionalNotes;
                }
                
                // Clear and reselect appliances
                document.querySelectorAll('.appliance-item.selected').forEach(item => {
                    item.classList.remove('selected');
                });
                
                // Clear custom appliances
                const customAppliances = document.querySelectorAll('.appliance-item[data-id^="custom-"]');
                customAppliances.forEach(item => item.remove());
                
                // Add appliances from calculation
                if (calculation.configuration.appliances && calculation.configuration.appliances.length > 0) {
                    calculation.configuration.appliances.forEach(appliance => {
                        if (appliance.id.startsWith('custom-')) {
                            // Add custom appliance
                            this.addCustomApplianceFromData(appliance);
                        } else {
                            // Select standard appliance
                            const applianceItem = document.querySelector(`.appliance-item[data-id="${appliance.id}"]`);
                            if (applianceItem) {
                                applianceItem.classList.add('selected');
                            }
                        }
                    });
                }
                
                // Update summary and safety warnings
                this.updateSummary();
                this.SafetyFeatures.displayWarnings();
                
                alert(`Loaded calculation: ${calculation.project.name}`);
            },
            
            /**
             * Helper to add custom appliance from data
             */
            addCustomApplianceFromData: function(appliance) {
                const applianceList = document.getElementById('applianceList');
                
                const item = document.createElement('div');
                item.className = 'appliance-item selected';
                item.dataset.id = appliance.id;
                item.dataset.nozzles = appliance.nozzles;
                item.dataset.price = appliance.price;
                
                item.innerHTML = `
                    <div class="appliance-name">${appliance.name}</div>
                    <div class="appliance-nozzles">${appliance.nozzles} nozzle${appliance.nozzles > 1 ? 's' : ''}</div>
                `;
                
                item.addEventListener('click', () => {
                    item.classList.toggle('selected');
                    this.updateSummary();
                    this.SafetyFeatures.displayWarnings();
                });
                
                applianceList.appendChild(item);
            },
            
            /**
             * Export calculation data
             */
            exportCalculation: function(format = 'json') {
                if (!this.currentCalculation) {
                    const saved = localStorage.getItem('kfss_last_calculation');
                    if (!saved) {
                        alert('No calculation to export. Please perform a calculation first.');
                        return;
                    }
                    this.currentCalculation = JSON.parse(saved);
                }
                
                if (format === 'json') {
                    const dataStr = JSON.stringify(this.currentCalculation, null, 2);
                    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                    const exportFileDefaultName = `kfss-calculation-${this.currentCalculation.id}.json`;
                    
                    const linkElement = document.createElement('a');
                    linkElement.setAttribute('href', dataUri);
                    linkElement.setAttribute('download', exportFileDefaultName);
                    linkElement.click();
                } else if (format === 'csv') {
                    this.exportAsCSV();
                }
            },
            
            /**
             * Export as CSV
             */
            exportAsCSV: function() {
                if (!this.currentCalculation) {
                    alert('No calculation to export');
                    return;
                }
                
                const calc = this.currentCalculation;
                const symbol = this.currencySymbols[calc.project.currency] || '$';
                
                let csv = 'KFSS Calculator Export\n';
                csv += 'Date,' + new Date(calc.timestamp).toLocaleString() + '\n';
                csv += 'Project,' + calc.project.name + '\n';
                csv += 'Client,' + calc.project.client + '\n';
                csv += 'Currency,' + calc.project.currency + '\n\n';
                
                csv += 'System Configuration\n';
                csv += 'Hood Length,' + calc.configuration.hood.length + ' m\n';
                csv += 'Hood Depth,' + calc.configuration.hood.depth + ' m\n';
                csv += 'Hood Area,' + calc.configuration.hood.area.toFixed(1) + ' mÂ²\n';
                csv += 'Plenum Sections,' + calc.configuration.hood.plenumSections + '\n';
                csv += 'Duct Sections,' + calc.configuration.hood.ductSections + '\n\n';
                
                csv += 'Cost Breakdown\n';
                csv += 'Description,Quantity,Unit Price,Total\n';
                
                Object.entries(calc.results.subtotals).forEach(([key, value]) => {
                    const label = key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
                    csv += `${label},1,${symbol}${value.toFixed(2)},${symbol}${value.toFixed(2)}\n`;
                });
                
                csv += `\nTotal System Cost,${symbol}${calc.results.totalCost.toFixed(2)}\n`;
                
                const dataUri = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);
                const exportFileDefaultName = `kfss-calculation-${calc.id}.csv`;
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
            },
            
            /**
             * Generate shareable link
             */
            generateShareableLink: function() {
                if (!this.currentCalculation) {
                    const saved = localStorage.getItem('kfss_last_calculation');
                    if (!saved) {
                        alert('No calculation to share. Please perform a calculation first.');
                        return;
                    }
                    this.currentCalculation = JSON.parse(saved);
                }
                
                const data = btoa(JSON.stringify(this.currentCalculation));
                const link = `${window.location.origin}${window.location.pathname}?data=${data}`;
                
                navigator.clipboard.writeText(link).then(() => {
                    alert('Shareable link copied to clipboard!\n\nYou can send this link to others to view this calculation.');
                }).catch(() => {
                    const copyText = prompt('Copy this link to share:', link);
                    if (copyText) {
                        alert('Link copied!');
                    }
                });
            },
            
            /**
             * Import from URL parameter
             */
            importFromURL: function() {
                const urlParams = new URLSearchParams(window.location.search);
                const data = urlParams.get('data');
                
                if (data) {
                    try {
                        const calculation = JSON.parse(atob(data));
                        this.currentCalculation = calculation;
                        localStorage.setItem('kfss_last_calculation', JSON.stringify(calculation));
                        this.loadRecentCalculation(calculation.id);
                    } catch (error) {
                        console.error('Error importing from URL:', error);
                    }
                }
            },
            
            /**
             * Helper function to update element text
             */
            updateElementText: function(id, text) {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = text;
                }
            }
        };
        
        // Initialize calculator when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing calculator...');
            KFSSCalculator.init();
            KFSSCalculator.importFromURL();
        });
    </script>
    
    <style>
        /* Additional styles for export dropdown */
        .dropdown {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-toggle {
            cursor: pointer;
            position: relative;
            padding-right: 30px;
        }
        
        .dropdown-toggle:after {
            content: "â–¼";
            font-size: 0.7em;
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .dropdown-menu {
            display: none;
            position: absolute;
            background: white;
            min-width: 180px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            border-radius: var(--radius-sm);
            z-index: 100;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .dropdown:hover .dropdown-menu {
            display: block;
        }
        
        .dropdown-item {
            display: block;
            padding: 12px 15px;
            color: var(--dark);
            text-decoration: none;
            border-bottom: 1px solid #eee;
            transition: var(--transition);
        }
        
        .dropdown-item:hover {
            background: var(--gray-light);
            color: var(--primary);
        }
        
        .dropdown-item:last-child {
            border-bottom: none;
        }
        
        .dropdown-item i {
            margin-right: 8px;
            width: 20px;
        }
        
        /* Emergency Guidance Styles */
        .emergency-guidance {
            background: linear-gradient(135deg, #f5f5f5, #e8e8e8);
            padding: 3rem 0;
            margin: 3rem 0;
            border-top: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
        }
        
        .emergency-guidance h2 {
            text-align: center;
            color: var(--primary);
            margin-bottom: 2rem;
        }
        
        .guidance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 1rem;
        }
        
        .guidance-card {
            background: white;
            padding: 25px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .guidance-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .guidance-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            margin-bottom: 20px;
        }
        
        .guidance-icon.emergency {
            background: #ffebee;
            color: var(--primary);
        }
        
        .guidance-icon.warning {
            background: #fff8e1;
            color: #f9a825;
        }
        
        .guidance-icon.info {
            background: #e3f2fd;
            color: #1565c0;
        }
        
        .guidance-card h3 {
            color: var(--secondary);
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .guidance-card ul {
            list-style: none;
            padding: 0;
        }
        
        .guidance-card li {
            margin-bottom: 10px;
            padding-left: 25px;
            position: relative;
            line-height: 1.5;
        }
        
        .guidance-card li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: var(--success);
            font-weight: bold;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-fire-extinguisher"></i>
                    <div>
                        <h1>Professional KFSS Calculator</h1>
                        <span>Kitchen Fire Suppression System Design Tool</span>
                    </div>
                </div>
                <div class="standards">
                    <i class="fas fa-shield-alt"></i> Compliant with NFPA 96 & NFPA 17A
                </div>
            </div>
        </div>
    </header>
    
    <!-- Navigation -->
    <nav class="main-nav">
        <div class="container">
            <ul>
                <li class="active"><a href="index.html"><i class="fas fa-calculator"></i> Calculator</a></li>
                <li><a href="results.html"><i class="fas fa-list-alt"></i> Results</a></li>
                <li><a href="quotation.html"><i class="fas fa-file-invoice-dollar"></i> Quotation</a></li>
                <li class="mode-toggle">
                    <label class="switch">
                        <input type="checkbox" id="expertModeToggle">
                        <span class="slider"></span>
                    </label>
                    <span class="mode-label">Expert Mode</span>
                </li>
            </ul>
        </div>
    </nav>
    
    <!-- Main Content -->
    <div class="container">
        <div class="page-header">
            <h2><i class="fas fa-project-diagram"></i> Kitchen Fire Suppression System Calculator</h2>
            <p>Design and calculate wet chemical systems compliant with NFPA standards</p>
        </div>
        
        <!-- Alert Banner -->
        <div class="alert alert-info">
            <i class="fas fa-info-circle"></i>
            <span>All calculations are based on NFPA 96 and NFPA 17A standards for wet chemical kitchen fire suppression systems.</span>
        </div>
        
        <main>
            <!-- Left Column -->
            <div class="column">
                <!-- Project Info Card -->
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-project-diagram"></i> Project Information</h3>
                    
                    <div class="form-group">
                        <label for="projectName" class="required">Project Name</label>
                        <input type="text" id="projectName" placeholder="Enter project name" value="Commercial Kitchen Design">
                    </div>
                    
                    <div class="form-group">
                        <label for="clientName" class="required">Client Name</label>
                        <input type="text" id="clientName" placeholder="Enter client name" value="Restaurant Corporation">
                    </div>
                    
                    <div class="form-group">
                        <label for="projectLocation">Project Location</label>
                        <input type="text" id="projectLocation" placeholder="City, State">
                    </div>
                    
                    <div class="currency-selector">
                        <label for="currency">Currency:</label>
                        <select id="currency">
                            <option value="USD">USD ($)</option>
                            <option value="EUR">EUR (â‚¬)</option>
                            <option value="INR">INR (â‚¹)</option>
                            <option value="AED">AED (Ø¯.Ø¥)</option>
                        </select>
                    </div>
                </div>
                
                <!-- Hood & Duct Configuration -->
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-warehouse"></i> Hood & Duct Configuration</h3>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="hoodLength" class="required">Hood Length (m)</label>
                            <div class="input-with-unit">
                                <input type="number" id="hoodLength" min="0.5" max="20" step="0.1" value="3.0">
                                <span class="unit">meters</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="hoodDepth" class="required">Hood Depth (m)</label>
                            <div class="input-with-unit">
                                <input type="number" id="hoodDepth" min="0.5" max="5" step="0.1" value="1.2">
                                <span class="unit">meters</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="plenumSections" class="required">Plenum Sections</label>
                            <input type="number" id="plenumSections" min="1" max="10" value="2">
                        </div>
                        
                        <div class="form-group">
                            <label for="ductSections" class="required">Duct Openings</label>
                            <input type="number" id="ductSections" min="0" max="10" value="1">
                        </div>
                    </div>
                    
                    <!-- Expert Mode Additional Fields -->
                    <div id="expertHoodPanel" class="expert-panel">
                        <div class="form-group">
                            <label for="hoodMaterial">Hood Material</label>
                            <select id="hoodMaterial">
                                <option value="stainless">Stainless Steel</option>
                                <option value="galvanized">Galvanized Steel</option>
                                <option value="aluminum">Aluminum</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="ductLength">Duct Length (m)</label>
                            <div class="input-with-unit">
                                <input type="number" id="ductLength" min="0" max="50" step="0.5" value="5.0">
                                <span class="unit">meters</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Appliance Selection -->
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-utensils"></i> Appliance Selection</h3>
                    <p>Select the appliances under the hood:</p>
                    
                    <div class="appliance-list" id="applianceList">
                        <!-- Appliance items will be generated by JavaScript -->
                    </div>
                    
                    <div class="form-group" style="margin-top: 20px;">
                        <label for="customAppliance">Add Custom Appliance</label>
                        <div class="custom-appliance-form">
                            <input type="text" id="customAppliance" placeholder="Appliance name">
                            <input type="number" id="customNozzles" min="1" max="5" placeholder="Nozzles" value="1">
                            <button id="addCustomAppliance" class="btn btn-outline">
                                <i class="fas fa-plus"></i> Add
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right Column -->
            <div class="column">
                <!-- System Summary -->
                <div class="card summary-card">
                    <h3 class="card-title"><i class="fas fa-calculator"></i> System Summary</h3>
                    
                    <div class="summary-grid">
                        <div class="summary-item">
                            <div class="summary-label">Hood Area</div>
                            <div class="summary-value" id="summaryHoodArea">3.6 mÂ²</div>
                        </div>
                        
                        <div class="summary-item">
                            <div class="summary-label">Plenum Nozzles</div>
                            <div class="summary-value" id="summaryPlenumNozzles">2</div>
                        </div>
                        
                        <div class="summary-item">
                            <div class="summary-label">Duct Nozzles</div>
                            <div class="summary-value" id="summaryDuctNozzles">1</div>
                        </div>
                        
                        <div class="summary-item">
                            <div class="summary-label">Appliance Nozzles</div>
                            <div class="summary-value" id="summaryApplianceNozzles">0</div>
                        </div>
                        
                        <div class="summary-item">
                            <div class="summary-label">Total Nozzles</div>
                            <div class="summary-value highlight" id="summaryTotalNozzles">3</div>
                        </div>
                        
                        <div class="summary-item">
                            <div class="summary-label">Cylinders Required</div>
                            <div class="summary-value" id="summaryCylinders">1</div>
                        </div>
                        
                        <div class="summary-item">
                            <div class="summary-label">Agent Weight</div>
                            <div class="summary-value" id="summaryAgentWeight">5.7 kg</div>
                        </div>
                        
                        <div class="summary-item">
                            <div class="summary-label">Piping Length</div>
                            <div class="summary-value" id="summaryPiping">11 m</div>
                        </div>
                    </div>
                    
                    <div class="total-cost">
                        <div class="total-label">Estimated System Cost</div>
                        <div class="total-value" id="summaryCost">$4,850.25</div>
                        <div class="currency-note">in <span id="summaryCurrency">USD</span></div>
                    </div>
                    
                    <div class="action-buttons">
                        <button id="calculateBtn" class="btn btn-primary btn-lg">
                            <i class="fas fa-calculator"></i> Calculate & View Details
                        </button>
                        <button id="resetBtn" class="btn btn-outline">
                            <i class="fas fa-redo"></i> Reset
                        </button>
                        <div class="dropdown">
                            <button class="btn btn-outline dropdown-toggle">
                                <i class="fas fa-download"></i> Export
                            </button>
                            <div class="dropdown-menu">
                                <a href="#" id="exportJson" class="dropdown-item">
                                    <i class="fas fa-file-code"></i> JSON
                                </a>
                                <a href="#" id="exportCsv" class="dropdown-item">
                                    <i class="fas fa-file-csv"></i> CSV
                                </a>
                                <a href="#" id="shareLink" class="dropdown-item">
                                    <i class="fas fa-share"></i> Share Link
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Safety Warnings Card -->
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-shield-alt"></i> Safety Compliance Check</h3>
                    <div id="safetyWarnings">
                        <div class="safety-status loading">
                            <div class="spinner small"></div>
                            <div>
                                <strong>Checking safety requirements...</strong>
                                <small>Validating against NFPA standards</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Recent Calculations -->
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-history"></i> Recent Calculations</h3>
                    <div id="recentCalculations">
                        <div class="empty-state">
                            <i class="fas fa-clock"></i>
                            <p>No recent calculations</p>
                            <small>Your calculations will appear here</small>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Help -->
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-question-circle"></i> Quick Help</h3>
                    <ul class="help-list">
                        <li><i class="fas fa-check-circle"></i> One nozzle required per plenum section</li>
                        <li><i class="fas fa-check-circle"></i> One nozzle required per duct opening</li>
                        <li><i class="fas fa-check-circle"></i> Standard nozzle coverage: 600mm Ã— 600mm area</li>
                        <li><i class="fas fa-check-circle"></i> Cylinder selection based on max nozzles per cylinder</li>
                        <li><i class="fas fa-check-circle"></i> Piping estimate: 2m per nozzle + 5m main run</li>
                    </ul>
                </div>
            </div>
        </main>
        
        <!-- Expert Panel (Collapsed by default) -->
        <div class="card expert-panel-card" id="expertPanel">
            <h3 class="card-title"><i class="fas fa-cogs"></i> Expert Configuration</h3>
            <div class="expert-panel-content">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="nozzleType">Nozzle Type</label>
                        <select id="nozzleType">
                            <option value="standard">Standard Appliance Nozzle</option>
                            <option value="high-flow">High-Flow Plenum Nozzle</option>
                            <option value="low-flow">Low-Flow Extended Coverage</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="pipeMaterial">Piping Material</label>
                        <select id="pipeMaterial">
                            <option value="galvanized">Galvanized Steel</option>
                            <option value="stainless">Stainless Steel</option>
                            <option value="copper">Copper</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="safetyFactor">Safety Factor (%)</label>
                        <div class="input-with-unit">
                            <input type="number" id="safetyFactor" min="0" max="50" step="5" value="10">
                            <span class="unit">%</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="pressureRating">System Pressure (PSI)</label>
                            <div class="input-with-unit">
                            <input type="number" id="pressureRating" min="50" max="300" step="10" value="100">
                            <span class="unit">PSI</span>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="additionalNotes">Additional Notes</label>
                    <textarea id="additionalNotes" rows="3" placeholder="Add any special requirements or notes..."></textarea>
                </div>
            </div>
        </div>
        
        <!-- Emergency Procedures Section -->
        <section class="emergency-guidance">
            <div class="container">
                <h2><i class="fas fa-exclamation-triangle"></i> Emergency Response Guidelines</h2>
                <div class="guidance-grid">
                    <div class="guidance-card">
                        <div class="guidance-icon emergency">
                            <i class="fas fa-fire"></i>
                        </div>
                        <h3>Kitchen Fire Emergency</h3>
                        <ul>
                            <li>Activate manual release station immediately</li>
                            <li>Evacuate all personnel from the area</li>
                            <li>Call emergency services (911/112)</li>
                            <li>Do not re-enter until cleared by fire department</li>
                        </ul>
                    </div>
                    
                    <div class="guidance-card">
                        <div class="guidance-icon warning">
                            <i class="fas fa-exclamation"></i>
                        </div>
                        <h3>System Maintenance</h3>
                        <ul>
                            <li>Monthly visual inspection of all components</li>
                            <li>Annual professional inspection required</li>
                            <li>Test manual release station quarterly</li>
                            <li>Keep area around cylinders clear (1m radius)</li>
                        </ul>
                    </div>
                    
                    <div class="guidance-card">
                        <div class="guidance-icon info">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <h3>Staff Training</h3>
                        <ul>
                            <li>Train all kitchen staff on system operation</li>
                            <li>Conduct fire drills every 6 months</li>
                            <li>Post emergency procedures in kitchen</li>
                            <li>Maintain training records</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Explore Tools Section -->
        <section class="explore-tools">
            <h2><i class="fas fa-star"></i> Explore More Calculators & Tools</h2>
            <p class="section-subtitle">We highly recommend these expert resources for specialized safety and utility tools:</p>
            <div class="tools-grid">
                <div class="tool-card">
                    <div class="tool-icon">ðŸ”¥</div>
                    <h3>Fire Safety Tool</h3>
                    <p>Comprehensive suite of NFPA & IBC compliant calculators for clean agent, COâ‚‚, foam systems, and egress planning.</p>
                    <a href="https://www.firesafetytool.com" target="_blank" class="tool-link">Visit Site <i class="fas fa-external-link-alt"></i></a>
                </div>
                <div class="tool-card">
                    <div class="tool-icon">ðŸ›¡ï¸</div>
                    <h3>HSE Calculator</h3>
                    <p>Health, Safety & Environment tools for risk assessment, noise exposure, incident rates, and compliance management.</p>
                    <a href="https://www.hsecalculator.com" target="_blank" class="tool-link">Visit Site <i class="fas fa-external-link-alt"></i></a>
                </div>
                <div class="tool-card">
                    <div class="tool-icon">âš™ï¸</div>
                    <h3>Web Tools Daily</h3>
                    <p>Collection of free, privacy-focused utilities like image converters and formatters that work directly in your browser.</p>
                    <a href="https://www.webtoolsdaily.com" target="_blank" class="tool-link">Visit Site <i class="fas fa-external-link-alt"></i></a>
                </div>
                <div class="tool-card">
                    <div class="tool-icon">ðŸ“‹</div>
                    <h3>Fire Extinguisher Audit</h3>
                    <p>Streamline fire safety inspections with automated audit reporting and compliance tracking.</p>
                    <a href="https://fire-extinguisher-audit-tool.vercel.app" target="_blank" class="tool-link">Try Tool <i class="fas fa-external-link-alt"></i></a>
                </div>
                <div class="tool-card">
                    <div class="tool-icon">ðŸ“Š</div>
                    <h3>Fire Safety Assessment</h3>
                    <p>Complete fire safety risk assessment platform for commercial and residential buildings.</p>
                    <a href="https://firesafetyassessmenttool.vercel.app" target="_blank" class="tool-link">Try Tool <i class="fas fa-external-link-alt"></i></a>
                </div>
                <div class="tool-card">
                    <div class="tool-icon">ðŸ’°</div>
                    <h3>Ceiling Fire Extinguisher Cost Estimator</h3>
                    <p>Specialized cost estimation tool for ceiling-mounted fire extinguisher systems.</p>
                    <a href="https://ceiling-fire-extinguisher-cost-esti.vercel.app" target="_blank" class="tool-link">Try Tool <i class="fas fa-external-link-alt"></i></a>
                </div>
                <div class="tool-card">
                    <div class="tool-icon">ðŸ§¯</div>
                    <h3>Fire Extinguisher Calculator</h3>
                    <p>BIS 2190:2024 compliant calculator for determining exact fire extinguisher requirements.</p>
                    <a href="https://fire-extinguisher-calculator.vercel.app" target="_blank" class="tool-link">Try Tool <i class="fas fa-external-link-alt"></i></a>
                </div>
            </div>
        </section>
        
        <!-- Amazon Associates Banner -->
        <aside class="affiliate-banner">
            <a href="https://amzn.to/4p8ceG6" target="_blank" class="amazon-button">
                <span class="sale-badge">Clearance Sale! Up to 70% Off</span>
                <span class="banner-text">ðŸ”¥ Shop Fire Safety Equipment on Amazon</span>
                <i class="fas fa-bolt"></i>
            </a>
        </aside>
        
        <!-- Buy Me a Coffee -->
        <div class="coffee-container">
            <p>If this tool helped you, consider supporting our work:</p>
            <a href="https://buymeacoffee.com/s.amjathkhan" target="_blank" class="coffee-button">
                <img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee">
            </a>
        </div>
        
        <!-- Footer -->
        <footer>
            <div class="footer-content">
                <div class="footer-logo">
                    <i class="fas fa-fire-extinguisher"></i>
                    <span>KFSS Calculator</span>
                </div>
                <div class="footer-links">
                    <a href="index.html">Calculator</a>
                    <a href="results.html">Results</a>
                    <a href="quotation.html">Quotation</a>
                    <a href="#" onclick="window.print()">Print</a>
                </div>
                <div class="footer-disclaimer">
                    <p>Â© 2023 Fire Safety Solutions. This tool is for estimation purposes only. Final design must be verified by a licensed professional.</p>
                    <p>Compliant with NFPA 96 & NFPA 17A standards for wet chemical kitchen fire suppression systems.</p>
                </div>
            </div>
        </footer>
    </div>
</body>
</html>
